<!DOCTYPE html>
<html lang="vi">
<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# website: http://ogp.me/ns/website#">

    <meta property="og:type" content="website"/>
    <meta property="og:url" content="http://thiepdo.com/welcome"/>
    <meta property="og:description" content="{{ description }}"/>

    <meta property="og:title" content="Welcome"/>
    <meta property="og:image" content="/bundles/viettutweb/img/templates/welcome/main.jpg"/>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="robots" content="noindex"/>

    <link href="/bundles/viettutweb/img/thiepdo_120x120.png" sizes="120x120" rel="apple-touch-icon">
    <link rel="icon" sizes="144x144" href="/bundles/viettutweb/img/thiepdo_144x144.png">
    <link rel="icon" sizes="64x64" href="/bundles/viettutweb/img/thiepdo_64x64.png">

    <title>{{ name }}</title>

    <link rel="stylesheet" type="text/css" href="{{ asset('css/libraries.min.css') }}"/>
    <link rel="stylesheet" type="text/css" href="/bundles/viettutweb/css/templates/welcome/style.css"/>
    <link rel="stylesheet" type="text/css" href="/bundles/viettutweb/css/templates/welcome/app.css"/>

</head>
<body>
<h1 class="hide">Winter Wonderland - Vườn địa đàng</h1>
<h2 class="hide">Mẫu với phong cách truyền thống tôn vinh sự giản đơn nhưng không kém phần trang trọng.</h2>
<div id="coordinates" data-lon="{{ lon }}" data-lat="{{ lat }}" data-title="{{ data['place'] }}"></div>
<div id="card_id" data-id="{{ id }}"></div>
<div data-role="page" id="skin_page">
    <!-- panel-menu -->
    <div data-role="panel" id="right-panel" data-position="right" data-display="push" style="z-index:9999;">
        <div class="menu-wrap ui-panel-inner">
            <ul data-role="listview" data-icon="false">
                <li data-icon="delete"><a href="#" data-rel="close">닫기</a></li>
                <li class="menu_scrolls" data-rel="close" id="p_topinfo"><span>민트플라워 바자회에 초대합니다.</span></li>
                <li class="menu_scrolls" data-rel="close" id="p_invite"><span>초대합니다</span></li>
                <li class="menu_scrolls" data-rel="close" id="p_schedule"><span>KỊCH BẢN</span></li>
                <li class="menu_scrolls" data-rel="close" id="p_map"><span>ĐỊA ĐIỂM</span></li>
                <li class="menu_scrolls" data-rel="close" id="p_gallery"><span>THƯ VIỆN ẢNH</span></li>
                <li class="menu_scrolls" data-rel="close" id="p_media"><span>VIDEO</span></li>
                <li class="menu_scrolls" data-rel="close" id="p_snsbbs"><span>GÓP Ý</span></li>
            </ul>
        </div>
    </div>
    <!--// panel-menu -->

    <div class="lnb">
        <ul>
            <!--<li class="menu1 menu_scrolls on" id="m_topinfo"><span>민트플라워 바자회에 초대합니다.</span></li>-->
            <li class="menu1 menu_scrolls" id="m_invite"><span>초대합니다</span></li>
            <li class="menu2 menu_scrolls" id="m_schedule"><span>KỊCH BẢN</span></li>
            <li class="menu3 menu_scrolls" id="m_map"><span>ĐỊA ĐIỂM</span></li>
            <li class="menu4 menu_scrolls" id="m_gallery"><span>THƯ VIỆN ẢNH</span></li>
            <li class="menu5 menu_scrolls" id="m_media"><span>VIDEO</span></li>
            <li class="menu6 menu_scrolls" id="m_snsbbs"><span>GÓP Ý</span></li>
        </ul>
    </div>
    <div class="lnb_mobile"><a href="#right-panel">menu</a></div>

    <!-- header -->
    <div class="header" id="sk_topinfo">
        <div class="flower_left"></div>
        <div class="flower_right"></div>
        <div class="header_box">
            <div class="header_title">
                <h1 class="header_txt">
                    <img src="/bundles/viettutweb/img/templates/welcome/main_copy.png" alt="HOPE YOU COME<br />WELCOME"/>
                    <span class="title_to"></span>
                </h1>
                <div class="header_info" style="color:#2d2d42;">
                    <p class="loca color align_center">{{ data['event'] }}</p>
                    <p class="date color align_center">
                        {{ data['time'] | raw }}
                        <br>Địa điểm : {{ data['place'] | raw }}
                        <br> {{ data['place_addr'] }}
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!--// header -->

    <div class="content_wrap greeting_wrap">
        <!-- greeting -->
        <div class="greeting_box" id="sk_invite">
            <div class="greeting_content">
                <div class="greeting_area">
                    <h2 class="greeting_title"><strong>Nội dung chính</strong></h2>
                    <div class="content align_left" id="sk_invite_content">
                        {{ data['content'] | raw }}
                    </div>
                </div>
                <div class="flower_detail02"></div>
                <div class="contact_wrap" id="sk_sponsor">
                    <div class="contact_box">
                        <h3 class="title">Liên hệ</h3>
                        <p class="name">
                            {#<span id="sk_sponsor_position">조직회</span>#}
                            <span class="contact_name" id="sk_sponsor_name">{{ data['sponsor_name'] }}</span>
                            <span id="sk_sponsor_cname">{{ data['sponsor_org'] }}</span>
                        </p>
                    </div>
                    <div class="contact_info">
                        <a href="tel:{{ data['sponsor_phone'] }}" class="ui-link"><span class="phone"></span>Gọi điện</a>
                        <a href="sms:{{ data['sponsor_phone'] }}" class="ui-link"><span class="sms"></span>SMS</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--// greeting -->
    <!-- program -->
    <div class="content_wrap program_wrap">
        <span class="flower_detail03"></span>
        <div class="program_box" id="sk_schedule">
            <div class="program_content">
                <h2 class="program_title" id="sk_schedule_title"><span>Nội dung chương trình</span></h2>
                <div class="content align_left" id="sk_schedule_content">
                    {{ data['schedule_content'] | raw }}
                </div>
                <div class="flower_detail"></div>
                <div class="dday_wrap">
                    <div class="dday_box">
                        {#<h3 class="title">D-day Information</h3>#}
                        {#<span>앞으로 275일 남았습니다</span>#}
                        <span>{{ date | long_date }}</span>
                    </div>
                    <div class="dday">{{ date | date('H.i') }}</div>
                </div>
            </div>
        </div>
    </div>
    <!--// program -->

    <!-- location -->
    <div class="content_wrap location_wrap" id="sk_map">
        <h2 class="title rotation"><span>ĐỊA ĐIỂM</span></h2>
        <div class="location_box">
            <div class="lo_map">
                <div class="map_roughmap">
                    <div id="wedding_pmap_canvas"  class="not_view_panel" style="width:100%;height:500px;"></div>
                </div>
            </div>

            <div class="nav_box" id="sk_navilink">
                <div class="col-3 nav_list">
                    {#<div class="nav-wrap">#}
                        <div class="ui-grid-a nav-m">
                            <form action='http://maps.google.com/maps' method='get' target='_blank' id="getHomePath">
                                <input type='text' name='saddr' placeholder="địa chỉ của bạn"/>
                                <input type='hidden' name='daddr' value='{{ data["place_addr"] }}' />
                            </form>
                            <div class="nav-1">
                                <div class="ui-btn-nav wedding_kimnavi">
                                    <span class="ui-btn ui-icon-nav1 ui-btn-icon-left ui-btn-b ui-corner-all ui-shadow ui-custom-btn fc-fff" onclick="getHomePath()">CHỈ ĐƯỜNG</span>
                                </div>
                            </div>
                        </div>
                    {#</div>#}
                </div>
                <div class="nav_info">※ Gõ chính xác địa chỉ của bạn vào ô ở trên.</div>
            </div>

            <div class="lctn_tlt">
                <span class="lctn_txt">Liên hệ</span>
            </div>
            <table class="lo_container">
                <tr>
                    <th class="th_loca"><span>Địa điểm</span></th>
                    <td>{{ data['place'] }}</td>
                </tr>
                <tr>
                    <th class="th_loca"><span>Địa chỉ</span></th>
                    <td>{{ data['place_addr'] }}</td>
                </tr>
                <tr>
                    <th class="th_tel"><span>Điện thoại</span></th>
                    <td>{{ data['place_phone'] }}</td>
                </tr>
            </table>


            <div class="lctn_tlt">
                <span class="lctn_txt">Hướng dẫn</span>
            </div>
            <table class="lo_container">
                <tr>
                    <th class="th_bus"><span>Xe bus</span></th>
                    <td>{{ data['bus_info'] }}</td>
                </tr>
            </table>
            <table class="lo_container">
                <tr>
                    <th class="th_subway"><span>Đỗ xe</span></th>
                    <td>{{ data['parking_info'] }}
                    </td>
                </tr>
            </table>
            <div class="lctn_tlt">
                <span class="lctn_txt">Thông tin khác</span>
            </div>
            <table class="lo_container">
                <tr>
                    <th class="th_info"><span>Chú ý</span></th>
                    <td class="topline">{{ data['note'] }}</td>
                </tr>
            </table>
        </div>
    </div>
    <!--// location -->

    <!-- gallery -->
    <div class="content_wrap gallery_wrap" id="sk_gallery">
        <h2 class="title gallery"><span>Thư viện ảnh</span></h2>
        <div class="ul-body">

            <div class="gal_list">
                <div class="col-3">
                    {% for img in gallery[0:6] %}
                        <a href="{{ img['src'] }}" class="swipebox ui-link" data-size="{{ img['size'] }}"
                           imgId="{{ loop.index }}">
                            <div class="ui-block-{{ loop.index % 3 }}"
                                 style="background:url('{{ img['src'] }}') center center no-repeat;background-size:cover;">
                            </div>
                        </a>
                    {% endfor %}
                </div>

                {% if gallery | length > 6 %}
                    <div class="gal_more">
                        <a href="{{ gallery[6]['src'] }}" class="swipebox" data-ajax="false"
                           data-size="{{ gallery[6]['size'] }}" imgId="7">Thêm</a>
                    </div>
                {% endif %}
                {% if gallery | length > 7 %}
                    {% for img in gallery[7:] %}
                        <div><a href="{{ img['src'] }}" class="swipebox" data-size="{{ img['size'] }}"
                                imgId="{{ loop.index + 7 }}"></a></div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
    <!--// gallery -->

    {% if isTemplate %}
        <!-- movie -->
        <div class="content_wrap movie_wrap" id="sk_media">
            <h2 class="hidden">Video</h2>
            <div class="ul-body">
                <div class="movie_container movie1">
                    <ul style="z-index:99999;">
                        <li>
                            <iframe id="movie" width="100%"
                                    src="https://www.youtube.com/embed/JIRrGBnwBek?showinfo=0&autohide=1&rel=0&vq=hd1080"
                                    height="100%" frameborder="0" allowfullscreen></iframe>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <!--// movie -->
    {% else %}
        {% if embed %}
            <!-- movie -->
            <div class="content_wrap movie_wrap" id="sk_media">
                <h2 class="hidden">Video</h2>
                <div class="ul-body">
                    <div class="movie_container movie1">
                        <ul>
                            <li>
                                {{ embed | raw }}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <!--// movie -->
        {% endif %}
    {% endif %}


    <!-- guestbook -->
    <div class="content_wrap guestbook_wrap" id="sk_snsbbs">
        <h2 class="title guest"><span>Góp ý</span></h2>
        <div class="ul-body col-3">
            <div id="div_snsbbs">
                {% if isTemplate %}
                    <div class="snsbbs_sections">
                        <div class="ui-body-d">
                            <div class="gb_cont_box btn_go_snsbbs">
                                <div class="pro_info">
                                    <div class="pro_img">
                                        <img src="{{ asset('bundles/viettutweb/img/templates/winterwonderland/img_profile.png') }}" alt="profile picture">
                                    </div>
                                    <div class="pro_txt">
                                        <p><strong>Sunny</strong></p>
                                        <p class="date">2015-08-12 09:25</p>
                                    </div>
                                </div>
                                <ul class="gb_cont btn_go_snsbbs">
                                    <li class="comm_txt">
                                        <p>Hấp dẫn đấy. Mình sẽ đến thử xem sao</p>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="snsbbs_sections">
                        <div class="ui-body-d">
                            <div class="gb_cont_box btn_go_snsbbs">
                                <div class="pro_info">
                                    <div class="pro_img">
                                        <img src="{{ asset('bundles/viettutweb/img/templates/winterwonderland/img_profile.png') }}" alt="profile picture">
                                    </div>
                                    <div class="pro_txt">
                                        <p><strong>Yến Hoàng</strong></p>
                                        <p class="date">2015-08-07 13:35</p>
                                    </div>
                                </div>
                                <ul class="gb_cont btn_go_snsbbs">
                                    <li class="comm_txt">
                                        <p>Có cần vé vào cửa không nhỉ ?</p>
                                        <div class="emo-type-a emo02"></div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="snsbbs_sections">
                        <div class="ui-body-d">
                            <div class="gb_cont_box btn_go_snsbbs">
                                <div class="pro_info">
                                    <div class="pro_img">
                                        <img src="{{ asset('bundles/viettutweb/img/templates/winterwonderland/img_profile.png') }}" alt="profile picture">
                                    </div>
                                    <div class="pro_txt">
                                        <p><strong>Giang Giang</strong></p>
                                        <p class="date">2015-01-15 17:35</p>
                                    </div>
                                </div>
                                <ul class="gb_cont btn_go_snsbbs">
                                    <li class="comm_txt">
                                        <p>Xa quá, nếu gần thì chắc cũng chạy qua xem thế nào.</p>
                                        <div class="emo-type-a emo17"></div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="snsbbs_sections">
                        <div class="ui-body-d">
                            <div class="gb_cont_box btn_go_snsbbs">
                                <div class="pro_info">
                                    <div class="pro_img">
                                        <img src="{{ asset('bundles/viettutweb/img/templates/winterwonderland/img_profile.png') }}" alt="profile picture">
                                    </div>
                                    <div class="pro_txt">
                                        <p><strong>Nam Vũ</strong></p>
                                        <p class="date">2015-01-15 17:33</p>
                                    </div>
                                </div>
                                <ul class="gb_cont btn_go_snsbbs">
                                    <li class="comm_txt">
                                        <p>Đúng cái mình cần.</p>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="snsbbs_sections">
                        <div class="ui-body-d">
                            <div class="gb_cont_box btn_go_snsbbs">
                                <div class="pro_info">
                                    <div class="pro_img">
                                        <img src="{{ asset('bundles/viettutweb/img/templates/winterwonderland/img_profile.png') }}" alt="profile picture">
                                    </div>
                                    <div class="pro_txt">
                                        <p><strong>Liên Hương</strong></p>
                                        <p class="date">2015-01-15 17:33</p>
                                    </div>
                                </div>
                                <ul class="gb_cont btn_go_snsbbs">
                                    <li class="comm_txt">
                                        <p>Nhất định tôi sẽ đến sớm</p>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="snsbbs_sections">
                        <div class="ui-body-d">
                            <div class="gb_cont_box btn_go_snsbbs">
                                <div class="pro_info">
                                    <div class="pro_img">
                                        <img src="{{ asset('bundles/viettutweb/img/templates/winterwonderland/img_profile.png') }}" alt="profile picture">
                                    </div>
                                    <div class="pro_txt">
                                        <p><strong>Phương Phạm</strong></p>
                                        <p class="date">2015-01-15 17:32</p>
                                    </div>
                                </div>
                                <ul class="gb_cont btn_go_snsbbs">
                                    <li class="comm_txt">
                                        <p>Mình rất thích nghe anh này present, hấp dẫn mà nhiều ví dụ</p>
                                        <div class="emo-type-a emo04"></div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="snsbbs_sections">
                        <div class="ui-body-d">
                            <div class="gb_cont_box btn_go_snsbbs">
                                <div class="pro_info">
                                    <div class="pro_img">
                                        <img src="{{ asset('bundles/viettutweb/img/templates/winterwonderland/img_profile.png') }}" alt="profile picture">
                                    </div>
                                    <div class="pro_txt">
                                        <p><strong>Trường Sơn</strong></p>
                                        <p class="date">2015-01-15 17:30</p>
                                    </div>
                                </div>
                                <ul class="gb_cont btn_go_snsbbs">
                                    <li class="comm_txt">
                                        <p>Cuối cùng thì ngày này cũng đến ^^</p>
                                        <div class="emo-type-a emo06"></div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                {% else %}
                    {% for comment in comments %}
                        <div class="snsbbs_sections">
                            <div class="ui-body-d">
                                <div class="gb_cont_box btn_go_snsbbs">
                                    <div class="pro_info">
                                        <div class="pro_img">
                                            <img src="{{ comment.author.avatar }}" alt="profile picture">
                                        </div>
                                        <div class="pro_txt">
                                            <p><strong>{{ comment.author.name }}</strong></p>
                                            <p class="date">{{ comment.createdAt | date('d-m-Y H:i') }}</p>
                                        </div>
                                    </div>
                                    <ul class="gb_cont btn_go_snsbbs">
                                        <li class="comm_txt">
                                            <p>{{ comment.content }}</p>
                                            <div class="emo-type-a emo06"></div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
        {% if isTemplate %}
            <div class="gb_btn btn_go_snsbbs" onclick="guestBookAlert()"><span class="icons write"></span><strong>Bình luận</strong></div>
        {% else %}
            <div class="gb_btn btn_go_snsbbs" onclick="gotoGuestBook('{{ hash }}')"><span class="icons write"></span><strong>Bình luận</strong></div>
        {% endif %}
    </div>
    <!--// guestbook -->

    <!-- footer -->
    <div class="footer" id="sk_snslink">
        <div class="contents">
            <h4>
                <a href="{{ path('home_page') }}" target="_blank">
                    <img src="/bundles/viettutweb/img/templates/gardenwedding/lowercase-t-64-269636.png" alt="logo"
                         title="thiepdo.com"/>
                </a>
                <span></span>
            </h4>
            <ul>
                <div class="addthis_inline_share_toolbox"></div>
            </ul>
        </div>
    </div>
    <!--// footer -->
</div><!--//skin_page-->

<!-- photoswipe -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="pswp__bg"></div>
    <div class="pswp__scroll-wrap">
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <div class="pswp__ui pswp__ui--fit pswp__ui--hidden">
            <div class="pswp__top-bar">
                <div class="pswp__counter" data-role="none"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)" data-role="none"></button>
                <button class="pswp__button pswp__button--image" title="Include Image" data-role="none"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen" data-role="none"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out" data-role="none"></button>

                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"
                    data-role="none"></button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"
                    data-role="none"></button>

            <div class="pswp__caption">
                <div class="pswp__caption__center">Image caption 1</div>
            </div>

            <!-- 슬라이드
            <div class="pswp__slide">
                <label for="slide-show">자동 슬라이드</label>
                <input type="checkbox" name="slideShow" id="slide-show" data-role="none">
            </div>
            -->
        </div>
    </div>
</div>
{% if voted == false %}
    <div id="signup" class="signup">
        <div class="container">
            <div class="row">
                <i>Vui lòng cho biết dự định của bạn !</i>
            </div>
            <div class="row">
                <button class="btn btn-success" id="btn_going" onclick="updateStatus(1)">Sẽ đến</button>
                &nbsp;
                <button class="btn btn-warning" id="btn_notsure" onclick="updateStatus(2)">Cân nhắc</button>
                &nbsp;
                <button class="btn btn-danger" id="btn_notgoing" onclick="updateStatus(3)">Không đến</button>
            </div>
            {#<p class="text-center">#}
            {#</p>#}
            <a href="#" class="close"><i class="fa fa-times text-white"></i></a>
        </div>
    </div>
{% endif %}

<script src="{{ asset('js/libraries.min.js') }}"></script>
<script type="text/javascript">
    <!--
    $(function () {

        function fixScrollEvent() {
            $("html,body").on("mousewheel", function () {
                event.preventDefault();

                var wheelDelta = event.wheelDelta;
                var currentScrollPosition = window.pageYOffset;

                window.scrollTo(0, currentScrollPosition - wheelDelta);
            });

            $("html,body").on("keydown", function (e) {
                e.preventDefault();

                var currentScrollPosition = window.pageYOffset;

                switch (e.which) {
                    case 38: // up
                        window.scrollTo(0, currentScrollPosition - 120);
                        break;

                    case 40: // down
                        window.scrollTo(0, currentScrollPosition + 120);
                        break;

                    default:
                        return;
                }
            });
        }

        $(window).on("orientationchange", function () {
            callMapInitializeAfterResize();
        });

        function callMapInitializeAfterResize() {
            initialize('ceremony');
        }


        $('#div_snsbbs').masonry({
            //columnWidth: .snsbbs_sections,
            //isFitWidth : true,
            itemSelector: '.snsbbs_sections',
            transitionDuration: 0
        }).on('layoutComplete', function () {
            return true;
        });

        var closest = function closest(el, fn) {
            return el && (fn(el) ? el : closest(el.parentNode, fn));
        };

        var photoswipeParseHash = function () {
            var hash = window.location.hash.substring(1),
                    params = {};

            if (hash.length < 5) {
                return params;
            }

            var vars = hash.split('&');
            for (var i = 0; i < vars.length; i++) {
                if (!vars[i]) {
                    continue;
                }
                var pair = vars[i].split('=');
                if (pair.length < 2) {
                    continue;
                }
                params[pair[0]] = pair[1];
            }

            if (params.gid) {
                params.gid = parseInt(params.gid, 10);
            }

            return params;
        };

        function getGallery($el) {
            var el = [];
            var aTag = Array.prototype.slice.call($el.find("a"));

            $.merge(el, aTag);

            return el;
        }

        function onThumbnailsClick(e) {
            e = e || window.event;
            e.preventDefault ? e.preventDefault() : e.returnValue = false;

            var eTarget = e.target || e.srcElement;
            var clickedListItem = closest(eTarget, function (el) {
                var tagName = el.tagName.toUpperCase();
                return (tagName && tagName === 'A');
            });

            if (!clickedListItem) {
                return;
            }

            if (clickedListItem.className.indexOf("swipebox") == -1) {
                return false;
            }

            var childNodes = el,
                    numChildNodes = el.length,
                    nodeIndex = 0,
                    index = 0;

            var no_image_count = 0;
            for (var i = 0; i < numChildNodes; i++) {
                if (el[i].className.indexOf("swipebox") == -1) {
                    no_image_count++;
                }

                if (el[i] == clickedListItem) {
                    index = i - no_image_count;

                    break;
                }
            }

            if (index >= 0) {
                openPhotoSwipe(index, el);
            }

            return false;
        }

        var gallery;

        function getPrefix(prop) {
            var style = document.body.style;
            var prefix = ['Webkit', 'ms', 'moz', 'o'];
            var prefix_len = prefix.length;

            if (style[prop] == '') {
                return prop;
            }

            prop = prop[0].toUpperCase() + prop.slice(1);

            for (var i = 0; i < prefix_len; i++) {
                if (style[prefix[i] + prop] == '') {
                    return prefix[i] + prop;
                }
            }
        }

        function getTranslate(transform) {
            var regex;

            if (transform.indexOf('translate3d') == -1) {
                regex = /translate\(([-0-9.]+)px, ([-0-9.]+)px\)/;
            } else {
                regex = /translate3d\(([-0-9.]+)px, ([-0-9.]+)px, ([-0-9.]+)px\)/;
            }

            var matched = transform.match(regex);
            var coordinate = {};

            coordinate.x = matched[1];
            coordinate.y = matched[2];

            if (matched[3]) {
                coordinate.z = matched[3];
            }

            return coordinate;
        }

        function getScale(transform) {
            var regex = /scale\(([0-9.]+)\)/;
            var matched = transform.match(regex);

            return matched[1];
        }

        function psBeforeInitAddEvent() {
            gallery.listen('gettingData', function (index, item) {
                var size = item.el.getAttribute("data-size").split("X");

                item.w = size[0];
                item.h = size[1];
            });

            gallery.listen('arrowUpdate', function () {
                var $nextBtn = $('.pswp__button--arrow--right');
                var $prevBtn = $('.pswp__button--arrow--left');
                var loop = this.options.loop;
                var index = this.getCurrentIndex();

                $nextBtn.toggle(loop || index < this.items.length - 1);
                $prevBtn.toggle(loop || index > 0);
            });

            gallery.listen('initialZoomIn', function () {

            });
        }

        function psAfterInitAddEvent() {
            gallery.listen('initialZoomOut', function () {
                var item = this.currItem;
                var container_style = item.container.style;
                var transform = getPrefix('transform');
                var transition = getPrefix('transition');

                if (!transform || !transition) {
                    return;
                }

                var container_transform = container_style[getPrefix('transform')];
                var scale = getScale(container_transform);
                var coordinate = getTranslate(container_transform);
                var initTransY = item.initialPosition.y;
                var currTransY = coordinate.y;
                var size = item.el.getAttribute("data-size").split("X");
                var transX = item.initialPosition.x;
                var transY;

                if (initTransY > currTransY) {
                    transY = -(size[1]);
                } else {
                    transY = window.screen.availHeight;
                }

                container_style[transition] = "transform " + gallery.options.hideAnimationDuration + "ms";

                if (!this.isGestureClose() && this.isVerticalDrag()) {
                    container_style[getPrefix('transform')] = "translate3d(" + transX + "px, " + transY + "px, 0px) scale(" + scale + ")";
                }
            });

            gallery.listen('close', function () {
                this.framework.bind(window, 'scroll', function () {
                    if (typeof headerAnimate == "function") {
                        headerAnimate();
                    }
                });
            });
        }

        var openPhotoSwipe = function (index, galleryElement, disableAnimation, fromURL) {
            var pswpElement = document.querySelector('.pswp'),
                    options, items, kakaoInApp;

            items = parseThumbnailElements(galleryElement);

            if (/KAKAOTALK/.test(navigator.userAgent)) {
                kakaoInApp = true;
            }

            options = {
                useZoom: true,
                arrowKeys: false,
                hideAnimationDuration: 200,
                showAnimationDuration: 100,
                loop: false,
                imageEl: true,
                galleryUID: $my_gallery[0].getAttribute('data-pswp-uid'),
                showHideOpacity: true,
                getThumbBoundsFn: false,
                closeOnScroll: false,
                kakaoInApp: kakaoInApp,
            };

            if (fromURL) {
                if (options.galleryPIDs) {

                    for (var j = 0; j < items.length; j++) {
                        if (items[j].pid == index) {
                            options.index = j;
                            break;
                        }
                    }
                } else {
                    options.index = parseInt(index, 10);
                }
            } else {
                options.index = parseInt(index, 10);
            }

            if (isNaN(options.index)) {
                return;
            }

            if (disableAnimation) {
                options.showAnimationDuration = 0;
            }

            gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options);

            gallery.useAniNum = false;

            // 방명록 글쓰기에 이미지 첨부
            gallery.includeImage = function () {
                var id = gallery.currItem.id
                var url = "welcome/snsbbs/w/" + id;
                var kakaoInApp = gallery.options.kakaoInApp;

                if (!kakaoInApp) {
                    window.location = url;
                } else {
                    window.open(url);
                }
            }

            psBeforeInitAddEvent();
            gallery.init();
            psAfterInitAddEvent();
        };

        var parseThumbnailElements = function (el) {
            var imageElements = el,
                    numNodes = imageElements.length,
                    items = [],
                    size,
                    item;
            var wrapper = document.createElement('div');
            var imageEl,
                    thumbEl;

            for (var i = 0; i < numNodes; i++) {
                imageEl = imageElements[i];

                if (imageEl.nodeType !== 1) {
                    continue;
                }

                var img_el = imageEl.getElementsByTagName("img");
                var exist_img = img_el.length > 0 ? true : false;
                var src = imageEl.href;
                var is_swipe_image = imageEl.className.indexOf("swipebox") > -1 ? true : false;
                var msrc;
                var $imageEl = $(imageEl);

                if (!is_swipe_image) {
                    continue;
                }

                if (!exist_img) {
                    thumbEl = imageEl.getElementsByTagName("div")[0];

                    if (thumbEl) {
                        msrc = thumbEl.style.backgroundImage.slice(4, -1).replace(/"/g, "");
                    } else {
                        var piece = src.split("/");
                        var pieceCount = piece.length;
                        var file = piece[pieceCount - 1]

                        piece[pieceCount - 1] = "S_" + file;

                        msrc = piece.join("/");
                    }
                } else {
                    if ($imageEl.parent(".gal_more").length > 0 || $imageEl.children(".gal_more").length > 0) {
                        msrc = img_el[0].parentNode.href;
                    } else {
                        thumbEl = img_el[0];
                        msrc = thumbEl.src;
                    }
                }

                item = {
                    src: src,
                    msrc: msrc,
                    el: imageEl,
                };

                item.id = imageEl.getAttribute("imgId");
                items.push(item);
            }
            return items;
        };

        var $my_gallery = $("#sk_gallery");
        var my_gallery_count = $my_gallery.length;
        var el = getGallery($my_gallery);
        var $el = $(el);
        var hashData = photoswipeParseHash();

        $el.on("click", onThumbnailsClick);

        for (var i = 0; i < my_gallery_count; i++) {
            $my_gallery[i].setAttribute("data-pswp-uid", i + 1);
        }

        if (hashData.pid && hashData.gid) {
            openPhotoSwipe(hashData.pid - 1, el, true, true);
        }

        $(document).on("keydown keyup", function (e) {
            var hidden = $(".pswp").attr("aria-hidden") == "true";

            if (hidden) {
                return;
            }

            var keydownAction = '';
            var index = gallery.getCurrentIndex();
            var gallery_len = gallery.items.length;

            if (e.type == "keydown") {
                if (e.keyCode === 37 && index != 0) {
                    keydownAction = 'prev';
                } else if (e.keyCode === 39 && index != (gallery_len - 1)) {
                    keydownAction = 'next';
                }
            } else if (e.type == "keyup") {
                if (e.keyCode === 37 && index == 0) {
                    keydownAction = 'prev';
                } else if (e.keyCode === 39 && index == (gallery_len - 1)) {
                    keydownAction = 'next';
                }
            }

            if (keydownAction) {
                if (!e.ctrlKey && !e.altKey && !e.shiftKey && !e.metaKey) {
                    if (e.preventDefault) {
                        e.preventDefault();
                    } else {
                        e.returnValue = false;
                    }

                    gallery[keydownAction]();
                }
            }
        });

        $('#div_snsbbs').masonry('bindResize');

        function setPosition(id) {
            var $obj = $('#sk_' + id);
            $('body').scrollTo($obj, 500);
        }

        $('.menu_scrolls').click(function () {
            try {
                if ($(this).attr('id')) {
                    var id = $(this).attr('id').replace('p_', '').replace('m_', '');
                    setPosition(id);
                } else {
                    window.location.href = '/';
                }
            } catch (e) {
            }
        }).css('cursor', 'pointer');
    });

    $(window).load(function () {
        $('.gal_list2').masonry({
            itemSelector: '.gal_frame',
            columnWidth: '.gal_size',
            transitionDuration: '0.2s',
            percentPosition: true
        });

        $('#div_gallery').masonry({itemSelector: '.gallery_sections'});
    });

    function initMap() {
        var lat = $('#coordinates').data('lat');
        var lon = $('#coordinates').data('lon');
        var title = $('#coordinates').data('title');
        var location = {lat: lat, lng: lon};

        var map = new google.maps.Map(document.getElementById('wedding_pmap_canvas'), {
            zoom: 16,
            center: location
        });

        var marker = new google.maps.Marker({
            position: location,
            map: map
        });

        var info = new google.maps.InfoWindow({
            content: '<h4>' + title + '</h4>'
        });

        info.open(map, marker);
    }

    function getPath() {
        var addr = $('#getPath input[name=saddr]').val();

        if (addr.length < 3) {
            $('#getPath input[name=saddr]').focus();
            alert('Nhập địa chỉ của bạn một cách chính xác!');
            return;
        }

        document.getElementById("getPath").submit();
    }

    (function ($) {
        $.fn.onScrollTo = function (focusInFn, focusOutFn) {
            var $this = this;
            $(document).scroll(function () {
                var y = $(this).scrollTop();
                if (y >= $this.position().top) {
                    if (focusInFn) focusInFn();
                } else {
                    if (focusOutFn) focusOutFn();
                }
            });
        }
    })(jQuery);

    //-->
</script>
<script>
    WebFontConfig = {
        google: {
            families: ['Lora:400,500,900i&amp;subset=vietnamese']
        }
    };

    (function (d) {
        var wf = d.createElement('script'), s = d.scripts[0];
        wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js';
        wf.async = true;
        s.parentNode.insertBefore(wf, s);
    })(document);
</script>
<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDwFP7Gn3MRg3XxdnxZ33dKlgHQa7SanZE&callback=initMap">
</script>
<script async type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-52672eec5ea620cd"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-109753132-1"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-109753132-1');
</script>
</body>
</html>